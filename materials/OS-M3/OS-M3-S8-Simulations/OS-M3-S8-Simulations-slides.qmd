---
title: "Running Simulations and Power Analysis in R"
author: "Tejaswini Sharma"
date: "today"
date-format: "DD/MM/YYYY"
format: 
  revealjs:
    css: ../../../slides-custom.css # looks for css file in root
    footer: LMU Open Science Center
    slide-number: true
    logo: ../../../OSC_FORRT_Logo.png  # Inserts logo in the bottom right corner (default)
  pdf:
    geometry: 
      - top=30mm
      - left=30mm
  pptx: 
    css: ../../../slides-custom.css # looks for css file in root

bibliography: ../../../assets/references.bib
csl: ../../../assets/apa.csl

execute:
  echo: true
  eval: true
  engine: knitr
---

## Licence

<br>

<p style="text-align:center;">
  <img src="https://licensebuttons.net/l/by/4.0/88x31.png"
       alt="CC BY 4.0"
       style="height:50px;">
</p>

<div style="background-color: #f0f0f0; padding: 0.05em; border-radius: 2px; font-size: 0.6em;">
This work was originally created by [Mike Croucher ](https://github.com/mikecroucher) under a CC-BY-SA 4.0 [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by-sa/4.0/deed.en). It was subsequently adapted by [Malika Ihle](https://www.osc.uni-muenchen.de/about_us/coordinator/index.html) during her time at Reproducible Research Oxford. This current work by Sarah von Grebmer zu Wolfsthurn, Sara Lil Middleton and Malika Ihle is licensed under a CC-BY 4.0 [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/deed.en).
</div>

::: {.notes}
**Speaker Notes**: The Creative Commons Attribution 4.0 International (CC BY 4.0) license permits you to freely use, share, and adapt the licensed material for any purpose, including commercial use. This means you can copy, redistribute, remix, transform, and build upon the work without asking for permission.

However, there are some important conditions you must follow. You are required to give appropriate credit to the original creator, provide a link to the license, and indicate if you made any changes to the material. Additionally, you cannot apply any legal terms or technological measures that would restrict others from using the work under the same freedoms.
:::

---

## Contribution statement

<br>

**Creator**: Von Grebmer zu Wolfsthurn, Sarah (![ORCID Logo](https://orcid.org/sites/default/files/images/orcid_16x16.png)[ 0000-0002-6413-3895](https://orcid.org/0000-0002-6413-3895))

**Reviewer**: Ihle, Malika (![ORCID Logo](https://orcid.org/sites/default/files/images/orcid_16x16.png)[0000-0002-3242-5981](https://orcid.org/0000-0002-3242-5981))

**Consultant**: Middleton, Sara (![ORCID Logo](https://orcid.org/sites/default/files/images/orcid_16x16.png)[0000-0001-5307-8029](https://orcid.org/0000-0001-5307-8029))

::: {.notes}
**Speaker Notes**: These are the **speaker notes**. You will a script for the presenter for every slide. In presentation mode, your audience will not be able to see these speaker notes, they are only visible to the presenter. 

**Instructor Notes**: There are also **instructor notes**. For some slides, there will be pedagogical tips, suggestons for acitivities and troubleshooting tips for issues your audience might run into. You can find these notes underneath the speaker notes.

**Acessibility Tips**: Where applicable, this is a space to add any tips you may have to facilitate the accessibility of your slides and activities. 
:::

---

## Prerequisites

::: {.callout-important}
Before completing this submodule, please carefully read about the prerequisites.
:::

| Prerequisite   |  Description  | Link/Where to find it   |
|------------|------------|------------|
| Have R and RStudio installed | If you don’t, follow these instructions: | https://posit.co/download/rstudio-desktop/ |
| Know some R basics | e.g. how to select a value in a data frame, how to create a vector | [Download Link](https://lmu-osc.github.io/introduction-to-R/) |
| Basic statistical concepts | Like descriptive statistics, data analysis, statistical reasoning | [Download Link](to be updated) |

::: {.notes}
**Speaker Notes**: Before we begin this submodule, please take a moment to review the prerequisites listed here.
First, you should already have R and RStudio installed. If not, the link on the slide will guide you through the installation.
Next, you’ll need some basic familiarity with R — for example, how to select values in a data frame or how to create simple vectors. There’s a tutorial by OSC linked here in case you’d like to refresh those skills.
Finally, you should be comfortable with basic statistical concepts, such as descriptive statistics and fundamental data analysis ideas. There is a link to a cheatsheet on these concepts provided here.
If any of these areas feel unfamiliar, I encourage you to explore the resources before moving forward, so the rest of the tutorial is smooth and accessible. 
**Instructor Notes**: These are the prerequisites for this submodule. Before you get started on this submodule with your audience, you need to ensure that the audience fulfills these criteria. With a show of hands, you can know how many students would want to work through these resources provided; if the majority do, then a bit of time can be provided here, till they are comfortable to move forward.  
:::


---


## Questions from previous submodule

- **Aim**:  This first slide is dedicated to clarifying questions from the previous submodule and/or to discuss assignments. 
- Additional slides may need to be added depending on the nature of the homework assignments. 
- Critical for the learning process to ensure that students are on the same page and have been able to achieve the learning goals of the previous workshop. 
- Not applicable if this set of slides corresponds to the first submodule of a new module. 

::: {.notes}
**Speaker Notes**: Script for the slide here. 
**Instructor Notes**: <br>
- **Aim**:  This first slide is dedicated to clarifying questions from the previous submodule and/or to discuss assignments. 
- Additional slides may need to be added depending on the nature of the homework assignments. 
- Critical for the learning process to ensure that students are on the same page and have been able to achieve the learning goals of the previous workshop. 
- Not applicable if this set of slides corresponds to the first submodule of a new module. 
:::

---

## Before we start: Survey time!

- **Aim**: The pre-submodule survey serves to examine students' prior knowledge about simulations and power analysis, and familiarity with R.
- (QR code to be added soon)

::: {.notes}
**Speaker Notes**: Script for the slide here. 
**Instructor Notes**: <br>
- .
:::

---

**How confident are you in defining what a “simulation” is in the context of scientific research?**

a. Not confident.

b. Somewhat confident.

c. Confident.

d. Very confident

---

**Simulations are often used in research to… *(Select all you think apply)* **

a. Generate artificial data

b. Visualize complex statistical concepts

c. Replace all statistical analysis

d. Test how models perform under different scenarios

::: {.notes}
**Instructor Notes**: Correct Answer(s): a. Generate artificial data <br>
b. Visualize complex statistical concepts <br>
d. Test how models perform under different scenarios
- .
:::

---

**How familiar are you with the concept of “power” in statistics?**

a. I’ve never heard of it 

b. I know the term 

c. I understand the basics 

d. I’m comfortable with calculating power

---

**Power analysis is important for research because… *(Select all you think apply)* **

a. It helps determine how many samples you need

b. It ensures studies always find significant results

c. It helps you design more reliable studies

d. It explains all statistical results

::: {.notes}
**Instructor Notes**: Correct Answer(s): a. It helps determine how many samples you need <br>
c. It helps you design more reliable studies
- .
:::
---

**How comfortable are you with running basic R code and performing simple statistical analyses in R?**

a. Very uncomfortable

b. Somewhat uncomfortable 

c. Neutral

d. Somewhat comfortable

e. Very comfortable)

---

## Discussion of survey results


<br>

<div style="background-color: #f0f0f0; padding: 0.1em; border-radius: 5px; font-size: 1em; text-align: center;">

What do we see in the results?

</div>

::: {.notes}
**Speaker Notes**: Let us have a look at these results. 

**Instructor Notes**:

- **Aim**: Briefly examine the answers given to each question interactively with the group. Use visuals from the survey to highlight specific answers.

**Accessibility Tip**: Have people work in pairs if someone did not bring their phone/does not have a phone. This survey also cannot be completed in an asynchronous setting. 
:::

---

## Where are we at?

**Previously**:

- Point 1
- Point 2

<div style="background-color: #f0f0f0;">
**Up next**:

- Point 1
- Point 2
</div>


::: {.notes}
**Speaker Notes**: Script for the slide here.

**Instructor Notes**: <br>
- **Aim**: Place the topic of the current submodule within a broader context.
- Remind students what you are working towards and what the bigger picture is.
:::

---

## Covered in this session

- **Aim**: To understand the theoretical reasoning behind simulations and power analysis in R and the process of running these simulations.
- **Topics Covered**:
 - Simulations in research and basic process in R.
 - Power analysis and using simulations for it.

::: {.notes}
**Speaker Notes**: In this session, we’ll focus on the core ideas behind simulations and power analysis in R. First, we’ll look at what simulations are and the basic steps for running them. Then we’ll connect this to power analysis and see how simulations can support it. 
:::

---

## Learning goals

- Students will define the meaning of simulations and where they are used.
- Students will explain the need for simulations in research.
- Students will analyse the process of running a simulation in R, and apply the process to an example.
- Students will recall the concept of power analysis and its importance.
- Students will differentiate between traditional and simulation-based methods.
- Students will analyse the simulation process for power analyse.

  
::: {.notes}
**Speaker Notes**: In this session, we’ll work toward several learning goals, which reflect various sub-sections on the topic. These goals will be repeated after each sub-section so you can check your understanding, raise questions, and keep track of your progress.

**Instructor Notes**: Use this time to discuss any doubts the students may have on the learning goals and their assessment.
  
:::

---

## Key terms and definitions

- **Simulations**: Simulations are computer experiments that generate artificial data by pseudo-random sampling, allowing researchers to evaluate statistical methods under controlled, known conditions (Morris et al., 2019).
- **Power Analysis**: Power analysis is a statistical method used to determine the probability that a study will detect a true effect (if it exists) or, equivalently, the probability of correctly rejecting a false null hypothesis (Steidl et al., 1997). 
- **Effect Size**: Effect size quantifies the magnitude and direction of a difference or relationship between groups or variables (Lorah, 2018).

::: {.notes}
**Speaker Notes**: Here are a few key terms that will appear throughout the session.
We’ll use the word simulations to talk about computer-generated data created through pseudo-random sampling.
Power analysis refers to estimating the probability of detecting a true effect.
And effect size tells us how large or meaningful that effect is.
You don’t need to memorise these right now — this is just a quick introduction. We’ll return to these definitions later as we apply them, so for now simply get familiar with the terms.

**Instructor  Notes**: Introduce the terms briefly to activate students’ prior conceptions. Keep the slide short 
:::

---

## 1.1 What are Simulations?

**Let'S flip a coin** <br>
- Imagine you want to flip a coin *100 times*, and see the results.
- ~~Actually flipping the coin~~ -> Pretend to flip in mind...
 - And write down the results each time.
- This pretending is called a **simulation**.

::: {.notes}
**Speaker notes**: Imagine you want to find out how many times you might get heads if you flip a coin 100 times. Instead of flipping the coin for real, you can pretend to flip the coin many times in your mind or on paper and write down the results each time. This pretending is called a simulation.

**Instructor Notes**: Use this basic coin example to set the ground for 'simulations'. Encourage the students to ponder upon this example as a real experiment for a short bit, to understand how they can 'simulate' the data in their minds.
:::
---

## 1.1 What are Simulations?
#### contd...

- In a simulation, you make up data that acts like what you expect in the real world. 
- You do this again and again to see what kind of results you can get.

::: {.callout-tip}
## Try This Yourself
Run a **mental simulation** of flipping a coin a *100 times*. Make a note of how many times would you get heads and how many tails.
:::

::: {.notes}
**Speaker notes**: In this part, we’re looking at what simulations really are. A simulation basically means creating data that behaves the way we expect real-world data to behave. We repeat this process many times to see the range of outcomes we might get.
To get an intuitive feel for it, there’s a quick activity: imagine flipping a coin a hundred times. Think about how many heads and tails you’d expect. This mental experiment reflects the same logic behind running simulations in R.

**Instructor Notes**: Keep the explanation simple and intuitive. The goal here is to form an initial understanding before diving into technical detail.
:::

---

## 1.2 Why are Simulations Used in Research?

#### Before we begin...<br>
::: {.callout-tip}
## Create a Hypothesis
Get together in a pair, and create a hypothesis about the **coin flips**. For example, *When I flip the coin 100 times, the number of heads will be greater than tails.*
:::

::: {.notes}
**Speaker Notes**: Before we explore why simulations are important in research, we’ll start with a quick exercise: Pair up and create a simple hypothesis about the coin-flip scenario from earlier. For example: When I flip a coin 100 times, I’ll get more heads than tails.
This 'experiment' shall help you connect each point to your own hypothesis.

**Instructor Notes**: Give the students 2 minutes to develop their hypothesis; welcome creativity here.
:::

---

## 1.2 Why are Simulations Used in Research? *contd*

1. **To build statistical intuition**: Simulations let you see how data behaves—for example, why sometimes results are different even if you do the same experiment. <br>
2. **To understand sampling and probability**: Simulations help you picture what’s likely to happen and what’s unusual.  <br>
3. **To perform power analysis**: Scientists use simulations to check how likely their experiments are to find real effects.  <br>
4. **To support pre-Analysis planning**: Before running a real experiment, researchers simulate what they expect might happen. <br>
5. **To enable bootstrapping and flexible inference**: Simulations can reuse existing data to estimate any uncertainty without many strict assumptions. <br>

::: {.notes}
**Speaker Notes**: •	Build Statistical Intuition: Simulations let you see how data behaves, helping you grasp concepts like variability and sampling—things that formulas alone can’t easily show. This makes abstract ideas more concrete and understandable. <br>
•	Understand Sampling and Probability: By simulating repeated samples, you can visualize sampling distributions and understand why statistics like standard errors vary from sample to sample.<br>
•	Perform Power Analysis and Plan Studies: They help estimate the chance your study will detect a true effect (power), especially when study designs are complicated and formulas don’t work well.<br>
•	Support Pre-Analysis Planning: Researchers can simulate expected results before collecting real data, which helps catch problems early and improve research plans.<br>
•	Enable Bootstrapping and Flexible Inference: Simulations resample data to estimate confidence intervals without relying on strict assumptions, making analyses more robust.
:::

---

## 1.2 Why are Simulations Used in Research? *contd*

Most importantly, simulations promote **transparency** and **reproducibility**.

:::{.callout-tip}
## Relate it to your Hypothesis
Get together in your pair, and discuss how simulating your data for your experiment is useful, using any one of the pointers above.
:::

::: {.notes}
**Speaker Notes**: And its connection with open science? Simulations promote transparency and reproducibility since the code and data can be shared openly, allowing others to validate and extend the work. Open tools and tutorials make advanced statistical methods more accessible, democratizing research and education.

**Instructor Notes**: After discussing the pointers, let the students brainstorm and justify the simulation of data in their experiment, and share it in class.

---

## 1.3 Basic Simulation Process in R

<div style="text-align: center;">
  <img src="images/g (1).png" style="width:50%;" />
</div>

:::{.callout-tip}
## Relate it to your Hypothesis
Get together in your pair, and discuss how you would simulate your data according to this process.
:::

::: {.notes}
**Speaker Notes**: Here’s the basic process behind running a simulation.
First, decide how many data points (sample size) you want — for example, simulating a 100 coin flips. Thus, n = 100.
Next, generate the fake data using a random method that mimics the real outcome, such as randomly assigning ‘heads’ or ‘tails’ with equal probability.
Then analyse this simulated dataset just as you would analyse real data — you might count how many heads you got or calculate a simple summary.
After that, repeat the simulation many times to see how the results vary from run to run.
Finally, bring everything together by summarising the outcomes across all repetitions.
This gives you a clear picture of the variation you can expect if the experiment were done in real life.”

**Instructor Notes**: After discussing the pointers, let the students brainstorm and justify the simulation of data in their experiment, and share it in class.

---

## Learning Goals Check-In

[x] To define the meaning of simulations and where they are used. <br>
[x] To explain the need for simulations in research. <br>
[x] To analyse the process of running a simulation in R, and apply the process to an example.


::: {.notes}
**Speaker Notes**: Let’s pause for a quick check-in. Take a moment to look back at the learning goals for this section and reflect on how comfortable you feel with each one.<br>
If you notice any gaps, this is the right moment to bring them up — feel free to ask questions or start a discussion so we can address them before moving on.
:::

---

## 2.1 What is Power Analysis and its Importance?

**Let's flip the coin again, *but how many times?* ** <br>
- **Power analysis** is like figuring out how many times you need to flip a coin -> to be pretty sure you can tell if the coin is fair or not. <br>
- **Power** = your chance of catching the coin's true nature if it really is biased. <br>
 - If power = 80% -> you have an 80% chance of spotting a bias if it's really there. <br>

-Power depends on <br>
 - the effect size (*how biased the coin might be*) <br>
 - the sample size (*how many times you flip the coin*) <br>
 - the significance level (*how sure you want to be*)

::: {.notes}
**Speaker Notes**: In this section, we’re looking at what power analysis means and why it matters.
Think back to our coin example — the question now is: How many times should we flip the coin to confidently decide whether it’s fair?
Power analysis helps us figure that out.
Power is simply the chance of detecting a real effect if it truly exists.
So if the power is 80 percent, that means we have an 80 percent chance of noticing a bias when the coin is actually biased. <br>
Power depends on three things: the effect size — or how strong the bias might be, the sample size — how many flips we collect, and the significance level — how strict we want our decision rule to be.
Keep your earlier hypothesis in mind as we talk through these ideas.

**Instructor Notes**: This is the moment to clear out any confusion regarding the neighbouring concepts of effect size and significance level. If the students seem comfortable with the concepts, you can opt for a higher-level explanation reflecting the 'correctly rejecting a false null hypothesis' notion.
:::

---

## 2.1 What is Power Analysis and its Importance? *contd*

1. **Prevents Underpowered Studies**: It makes sure you don’t do an experiment that’s too small and miss something real. <br>
2. **Optimizes Resource Use**: helps you figure out the smallest number of times you need to do your experiment to have a good chance. This way, you don’t waste time or resources. <br>
3. **Required for Transparency and Publication**: a proof that your plan is strong enough. <br>

:::{.callout-tip}
## Relate it to your Hypothesis
Get together in your pair, and discuss how conducting power analysis for your experiment is useful, using any one of the pointers above.
:::

::: {.notes}
**Speaker Notes**: Prevents Underpowered Studies: Low power increases the risk of missing true effects, leading to inconclusive or misleading results. <br>
Optimizes Resource Use: Power analysis helps determine the minimum sample size needed, balancing scientific rigor with practical constraints. <br>
Required for Funding and Publication: Many funding agencies and journals require power analysis to justify sample size and study feasibility.
:::
---

## 2.2 Why Simulations are better for Power Analysis?

- **Quick formula method**: Imagine a simple math formula that tells you how many times to do something, like flipping a coin, to be pretty sure of your results. This method works fast and is good when the experiment is simple.

- **Simulation method**: This is like pretending to do the experiment many times on a computer before actually doing it. You create fake results based on what you think will happen. This way is better when the experiment is tricky or has many parts that are hard to predict.

---

## 2.3 Basic Simulation Process for Power Analysis in R

<div style="text-align: center;">
  <img src="Power Analysis Process.png" style="width:50%;" />
</div>

:::{.callout-tip}
## Relate it to your Hypothesis
Get together in your pair, and discuss how you would simulate your data according to this process.
:::

::: {.notes}
**Speaker Notes**: 1. Set up your model and data:
Decide what variables you have and how they behave (e.g., normal, binomial).
Choose sample size and any parameters (means, variances, effect size). <br>
2. Simulate one dataset:
Generate random data that follow your chosen distributions.<br>
Optionally “add” an effect (e.g., a difference between two groups).<br>
3. Analyse the simulated data:
Run the planned statistical test (e.g., t-test, regression).
Record the key result (e.g., p-value, estimate).<br>
4. Repeat the experiment many times:
Loop over steps 2–3 a large number of times.
Collect all test results into a single dataset.<br>
5. Summarise and interpret:
Compute the proportion of simulations with a significant result (this is the estimated power).
:::

---

## Learning Goals Check-In

[x] To recall the concept of power analysis and its importance. <br>
[x] To differentiate between traditional and simulation-based methods.  <br>
[x] To analyse the simulation process for power analyse.


::: {.notes}
**Speaker Notes**: Let’s pause for a quick check-in. Take a moment to look back at the learning goals for this section and reflect on how comfortable you feel with each one.<br>
If you notice any gaps, this is the right moment to bring them up — feel free to ask questions or start a discussion so we can address them before moving on.
:::

---

## Take-home message

- **Aim**: End lesson on clear take-home message that are interactively compiled by students.

::: {.callout-tip}
## Tip with Title
Add one practical tips or take-home message.
:::

::: {.notes}
**Speaker Notes**: Script for the slide here. 

**Instructor Notes**:

- **Aim**: End lesson on clear take-home message that are interactively compiled by students.
:::

---

## To conclude: Survey time!

- **Aim**: This post-submodule survey serves to examine students' current knowledge about the sumodule's topic.
- Use free survey software such as  particify or formR to establish the following questions (shown on separate slides)
- Use identical questions as in the pre-submodule survey to be able to directly compare

::: {.notes}
**Speaker Notes**: Script for the slide here. 

**Instructor Notes**:

- **Aim**: This post-submodule survey serves to examine students' current knowledge about the sumodule's topic.

- Use free survey software such as  particify or formR to establish the following questions (shown on separate slides)

- Use identical questions as in the pre-submodule survey to be able to directly compare
:::

---
##Qs
---

## Discussion of survey results

- **Aim**: Briefly examine the answers given to each question interactively with the group.
- Compare and highlight specific differences in answers between pre- and post-survey answers

::: {.notes}
**Speaker Notes**: Script for the slide here.

**Instructer Notes**:
- **Aim**: Briefly examine the answers given to each question interactively with the group.

- Compare and highlight specific differences in answers between pre- and post-survey answers
:::

---

## References {.smaller}

::: {#refs}
:::

::: {.notes}
**Speaker Notes**: Script for the slide here. 

**Instructor Notes**: Highlight particularly relevant reading for your students in bold. 
:::

---

# Thanks! <br>
See you next class :)

---

## License 

- This slide should contain information about the license details of this current set of slides. 

- The default for the created materials is [CC-BY-SA 4.0](https://creativecommons.org/licenses/by/4.0/)
  - = Creative Commons license that allows others to **share, adapt, and build upon** the original work
  - **only** if they attribute the creator and also share their new work under the **same terms**
  - allows for both **commercial and non-commercial** use of the licensed material

- Components of attributions: 
  - `Title`
  - `Author`
  - `Source`
  - `License`

---

## CREDiT Contribution Statement

Possible roles using the CRediT contribition system or the Zenodo Contribution System: 

**Name main content creator**: Conceptualization, Software, Writing - Original Draft, Visualization. **Sara Lil Middleton**: Writing - Review & Editing, Supervision. **Sarah von Grebmer zu Wolfsthurn**: Conceptualisation, Writing - Review & Editing, Supervision, Project Administration, Validation.

---
